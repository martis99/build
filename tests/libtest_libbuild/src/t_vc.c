#include "t_vc.h"

#include "gen/vc/vc_sln.h"

#include "common.h"
#include "mk_vc.h"
#include "test.h"

static const char *PROJ_C = "OUTDIR := $(SLNDIR)/bin/$(CONFIG)-$(PLATFORM)/test/\n"
			    "INTDIR := $(SLNDIR)/bin/$(CONFIG)-$(PLATFORM)/test/int/\n"
			    "REPDIR := $(OUTDIR)coverage-report/\n"
			    "DEPS := $(shell find src -name '*.h')\n"
			    "SRC_C := $(shell find src -name '*.c')\n"
			    "OBJ_C := $(patsubst %.c, $(INTDIR)%.o, $(SRC_C))\n"
			    "OBJ_D_C := $(patsubst %.c, $(INTDIR)%.d.o, $(SRC_C))\n"
			    "LCOV := $(OUTDIR)lcov.info\n"
			    "COV := $(patsubst %.c, $(INTDIR)%.gcno, $(SRC_C))\n"
			    "COV += $(patsubst %.c, $(INTDIR)%.gcda, $(SRC_C))\n"
			    "COV += $(LCOV) $(REPDIR)\n"
			    "TARGET := $(OUTDIR)test\n"
			    "\n"
			    "FLAGS := -Isrc\n"
			    "CFLAGS += $(FLAGS) -Wall -Wextra -Werror -pedantic\n"
			    "LDFLAGS +=\n"
			    "\n"
			    "RM += -r\n"
			    "\n"
			    "CONFIG_FLAGS :=\n"
			    "\n"
			    "ifeq ($(CONFIG), Debug)\n"
			    "CONFIG_FLAGS += -ggdb3 -O0\n"
			    "endif\n"
			    "\n"
			    "SHOW := true\n"
			    "\n"
			    ".PHONY: all check check_coverage compile coverage run clean\n"
			    "\n"
			    "all: compile\n"
			    "\n"
			    "check:\n"
			    "ifeq (, $(shell which gcc))\n"
			    "\tsudo apt install gcc -y\n"
			    "endif\n"
			    "\n"
			    "check_coverage: check\n"
			    "\t$(eval CONFIG_FLAGS += --coverage -fprofile-abs-path)\n"
			    "ifeq (, $(shell which lcov))\n"
			    "\tsudo apt install lcov -y\n"
			    "endif\n"
			    "\n"
			    "compile: check $(TARGET)\n"
			    "\n"
			    "coverage: clean check_coverage $(TARGET)\n"
			    "\t@$(TARGET) $(ARGS)\n"
			    "\t@lcov -q -c -d $(SLNDIR) -o $(LCOV)\n"
			    "ifeq ($(SHOW), true)\n"
			    "\t@genhtml -q $(LCOV) -o $(REPDIR)\n"
			    "\t@open $(REPDIR)index.html\n"
			    "endif\n"
			    "\n"
			    "$(TARGET): $(OBJ_C)\n"
			    "\t@mkdir -p $(@D)\n"
			    "\t@$(TCC) $(CONFIG_FLAGS) -o $@ $^ $(LDFLAGS)\n"
			    "\n"
			    "$(INTDIR)%.o: %.c\n"
			    "\t@mkdir -p $(@D)\n"
			    "\t@$(TCC) $(CONFIG_FLAGS) $(CFLAGS) -c -o $@ $<\n"
			    "\n"
			    "$(INTDIR)%.d.o: %.c\n"
			    "\t@mkdir -p $(@D)\n"
			    "\t@$(TCC) $(CONFIG_FLAGS) $(CFLAGS) -fPIC -c -o $@ $<\n"
			    "\n"
			    "run: check $(TARGET)\n"
			    "\t@$(TARGET) $(ARGS)\n"
			    "\n"
			    "clean:\n"
			    "\t@$(RM) $(TARGET) $(OBJ_C) $(OBJ_D_C) $(COV)\n";

static const char *PROJ_CPP = "OUTDIR := $(SLNDIR)/bin/$(CONFIG)-$(PLATFORM)/test/\n"
			      "INTDIR := $(SLNDIR)/bin/$(CONFIG)-$(PLATFORM)/test/int/\n"
			      "REPDIR := $(OUTDIR)coverage-report/\n"
			      "DEPS := $(shell find src -name '*.h')\n"
			      "DEPS += $(shell find src -name '*.hpp')\n"
			      "SRC_CPP := $(shell find src -name '*.cpp')\n"
			      "OBJ_CPP := $(patsubst %.cpp, $(INTDIR)%.o, $(SRC_CPP))\n"
			      "OBJ_D_CPP := $(patsubst %.cpp, $(INTDIR)%.d.o, $(SRC_CPP))\n"
			      "LCOV := $(OUTDIR)lcov.info\n"
			      "COV := $(patsubst %.cpp, $(INTDIR)%.gcno, $(SRC_CPP))\n"
			      "COV += $(patsubst %.cpp, $(INTDIR)%.gcda, $(SRC_CPP))\n"
			      "COV += $(LCOV) $(REPDIR)\n"
			      "TARGET := $(OUTDIR)test\n"
			      "\n"
			      "FLAGS := -Isrc\n"
			      "CXXFLAGS += $(FLAGS) -Wall -Wextra -Werror -pedantic\n"
			      "LDFLAGS += -lstdc++\n"
			      "\n"
			      "RM += -r\n"
			      "\n"
			      "CONFIG_FLAGS :=\n"
			      "\n"
			      "ifeq ($(CONFIG), Debug)\n"
			      "CONFIG_FLAGS += -ggdb3 -O0\n"
			      "endif\n"
			      "\n"
			      "SHOW := true\n"
			      "\n"
			      ".PHONY: all check check_coverage compile coverage run clean\n"
			      "\n"
			      "all: compile\n"
			      "\n"
			      "check:\n"
			      "ifeq (, $(shell which gcc))\n"
			      "\tsudo apt install gcc -y\n"
			      "endif\n"
			      "\n"
			      "check_coverage: check\n"
			      "\t$(eval CONFIG_FLAGS += --coverage -fprofile-abs-path)\n"
			      "ifeq (, $(shell which lcov))\n"
			      "\tsudo apt install lcov -y\n"
			      "endif\n"
			      "\n"
			      "compile: check $(TARGET)\n"
			      "\n"
			      "coverage: clean check_coverage $(TARGET)\n"
			      "\t@$(TARGET) $(ARGS)\n"
			      "\t@lcov -q -c -d $(SLNDIR) -o $(LCOV)\n"
			      "ifeq ($(SHOW), true)\n"
			      "\t@genhtml -q $(LCOV) -o $(REPDIR)\n"
			      "\t@open $(REPDIR)index.html\n"
			      "endif\n"
			      "\n"
			      "$(TARGET): $(OBJ_CPP)\n"
			      "\t@mkdir -p $(@D)\n"
			      "\t@$(TCC) $(CONFIG_FLAGS) -o $@ $^ $(LDFLAGS)\n"
			      "\n"
			      "$(INTDIR)%.o: %.cpp\n"
			      "\t@mkdir -p $(@D)\n"
			      "\t@$(TCC) $(CONFIG_FLAGS) $(CXXFLAGS) -c -o $@ $<\n"
			      "\n"
			      "$(INTDIR)%.d.o: %.cpp\n"
			      "\t@mkdir -p $(@D)\n"
			      "\t@$(TCC) $(CONFIG_FLAGS) $(CXXFLAGS) -fPIC -c -o $@ $<\n"
			      "\n"
			      "run: check $(TARGET)\n"
			      "\t@$(TARGET) $(ARGS)\n"
			      "\n"
			      "clean:\n"
			      "\t@$(RM) $(TARGET) $(OBJ_CPP) $(OBJ_D_CPP) $(COV)\n";

static const char *TASKS = "{\n"
			   "        \"version\": \"2.0.0\",\n"
			   "        \"tasks\": [\n"
			   "                {\n"
			   "                        \"label\": \"test-compile-Debug-x64\",\n"
			   "                        \"type\": \"shell\",\n"
			   "                        \"command\": \"make\",\n"
			   "                        \"args\": [\n"
			   "                                \"test/clean\",\n"
			   "                                \"test/compile\",\n"
			   "                                \"CONFIG=Debug\",\n"
			   "                                \"PLATFORM=x64\"\n"
			   "                        ],\n"
			   "                        \"group\": {\n"
			   "                                \"kind\": \"build\",\n"
			   "                                \"isDefault\": true\n"
			   "                        }\n"
			   "                },\n"
			   "                {\n"
			   "                        \"label\": \"test-run-Debug-x64\",\n"
			   "                        \"type\": \"shell\",\n"
			   "                        \"command\": \"make\",\n"
			   "                        \"args\": [\n"
			   "                                \"test/clean\",\n"
			   "                                \"test/run\",\n"
			   "                                \"CONFIG=Debug\",\n"
			   "                                \"PLATFORM=x64\"\n"
			   "                        ],\n"
			   "                        \"group\": {\n"
			   "                                \"kind\": \"build\",\n"
			   "                                \"isDefault\": true\n"
			   "                        }\n"
			   "                }\n"
			   "        ]\n"
			   "}";

static const char *LAUNCH = "{\n"
			    "        \"version\": \"0.2.0\",\n"
			    "        \"configurations\": [\n"
			    "                {\n"
			    "                        \"name\": \"test-compile-Debug-x64\",\n"
			    "                        \"type\": \"cppdbg\",\n"
			    "                        \"request\": \"launch\",\n"
			    "                        \"preLaunchTask\": \"test-compile-Debug-x64\",\n"
			    "                        \"program\": \"${workspaceFolder}/bin/Debug-x64/test/test\",\n"
			    "                        \"args\": [],\n"
			    "                        \"stopAtEntry\": false,\n"
			    "                        \"cwd\": \"${workspaceFolder}/test\",\n"
			    "                        \"environment\": [],\n"
			    "                        \"externalConsole\": false,\n"
			    "                        \"MIMode\": \"gdb\",\n"
			    "                        \"setupCommands\": [\n"
			    "                                {\n"
			    "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
			    "                                        \"text\": \"-enable-pretty-printing\",\n"
			    "                                        \"ignoreFailures\": true\n"
			    "                                },\n"
			    "                                {\n"
			    "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
			    "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
			    "                                        \"ignoreFailures\": true\n"
			    "                                }\n"
			    "                        ]\n"
			    "                }\n"
			    "        ]\n"
			    "}";

static const char *LAUNCH_ARGS = "{\n"
				 "        \"version\": \"0.2.0\",\n"
				 "        \"configurations\": [\n"
				 "                {\n"
				 "                        \"name\": \"test-compile-Debug-x64\",\n"
				 "                        \"type\": \"cppdbg\",\n"
				 "                        \"request\": \"launch\",\n"
				 "                        \"preLaunchTask\": \"test-compile-Debug-x64\",\n"
				 "                        \"program\": \"${workspaceFolder}/bin/Debug-x64/test/test\",\n"
				 "                        \"args\": [\n"
				 "                                \"-D\"\n"
				 "                        ],\n"
				 "                        \"stopAtEntry\": false,\n"
				 "                        \"cwd\": \"${workspaceFolder}/test\",\n"
				 "                        \"environment\": [],\n"
				 "                        \"externalConsole\": false,\n"
				 "                        \"MIMode\": \"gdb\",\n"
				 "                        \"setupCommands\": [\n"
				 "                                {\n"
				 "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
				 "                                        \"text\": \"-enable-pretty-printing\",\n"
				 "                                        \"ignoreFailures\": true\n"
				 "                                },\n"
				 "                                {\n"
				 "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
				 "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
				 "                                        \"ignoreFailures\": true\n"
				 "                                }\n"
				 "                        ]\n"
				 "                }\n"
				 "        ]\n"
				 "}";

static const char *OS_TASKS = "{\n"
			      "        \"version\": \"2.0.0\",\n"
			      "        \"tasks\": [\n"
			      "                {\n"
			      "                        \"label\": \"boot-bin-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"boot-bin/clean\",\n"
			      "                                \"boot-bin/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"boot-bin-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"boot-bin/clean\",\n"
			      "                                \"boot-bin/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"boot-bin-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"boot-bin/clean\",\n"
			      "                                \"boot-bin/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"boot-bin-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"boot-bin/clean\",\n"
			      "                                \"boot-bin/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"gcc-13.1.0-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"gcc-13.1.0/clean\",\n"
			      "                                \"gcc-13.1.0/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"gcc-13.1.0-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"gcc-13.1.0/clean\",\n"
			      "                                \"gcc-13.1.0/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"gcc-13.1.0-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"gcc-13.1.0/clean\",\n"
			      "                                \"gcc-13.1.0/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"gcc-13.1.0-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"gcc-13.1.0/clean\",\n"
			      "                                \"gcc-13.1.0/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-bin-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-bin/clean\",\n"
			      "                                \"kernel-bin/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-bin-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-bin/clean\",\n"
			      "                                \"kernel-bin/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-bin-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-bin/clean\",\n"
			      "                                \"kernel-bin/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-bin-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-bin/clean\",\n"
			      "                                \"kernel-bin/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-elf-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-elf/clean\",\n"
			      "                                \"kernel-elf/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-elf-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-elf/clean\",\n"
			      "                                \"kernel-elf/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-elf-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-elf/clean\",\n"
			      "                                \"kernel-elf/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"kernel-elf-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"kernel-elf/clean\",\n"
			      "                                \"kernel-elf/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-run-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/run\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-run-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/run\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-run-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/run\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-disk-run-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-disk/clean\",\n"
			      "                                \"image-disk/run\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-compile-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-compile-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/compile\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-compile-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-compile-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/compile\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-run-Debug-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/run\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-run-Debug-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/run\",\n"
			      "                                \"CONFIG=Debug\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-run-Release-x86_64\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/run\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=x86_64\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                },\n"
			      "                {\n"
			      "                        \"label\": \"image-floppy-run-Release-i386\",\n"
			      "                        \"type\": \"shell\",\n"
			      "                        \"command\": \"make\",\n"
			      "                        \"args\": [\n"
			      "                                \"image-floppy/clean\",\n"
			      "                                \"image-floppy/run\",\n"
			      "                                \"CONFIG=Release\",\n"
			      "                                \"PLATFORM=i386\"\n"
			      "                        ],\n"
			      "                        \"isBackground\": true,\n"
			      "                        \"problemMatcher\": [\n"
			      "                                {\n"
			      "                                        \"pattern\": [\n"
			      "                                                {\n"
			      "                                                        \"regexp\": \".\",\n"
			      "                                                        \"file\": 1,\n"
			      "                                                        \"location\": 2,\n"
			      "                                                        \"message\": 3\n"
			      "                                                }\n"
			      "                                        ],\n"
			      "                                        \"background\": {\n"
			      "                                                \"activeOnStart\": true,\n"
			      "                                                \"beginsPattern\": \".\",\n"
			      "                                                \"endsPattern\": \".\"\n"
			      "                                        }\n"
			      "                                }\n"
			      "                        ],\n"
			      "                        \"group\": {\n"
			      "                                \"kind\": \"build\",\n"
			      "                                \"isDefault\": true\n"
			      "                        }\n"
			      "                }\n"
			      "        ]\n"
			      "}\n";

static const char *OS_LAUNCH = "{\n"
			       "        \"version\": \"0.2.0\",\n"
			       "        \"configurations\": [\n"
			       "                {\n"
			       "                        \"name\": \"image-disk-compile-Debug-x86_64\",\n"
			       "                        \"type\": \"cppdbg\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-disk-compile-Debug-x86_64\",\n"
			       "                        \"program\": \"${workspaceFolder}/bin/Debug-x86_64/os/kernel/elf/kernel.elf\",\n"
			       "                        \"args\": [],\n"
			       "                        \"miDebuggerServerAddress\": \"localhost:1234\",\n"
			       "                        \"stopAtEntry\": false,\n"
			       "                        \"cwd\": \"${workspaceFolder}/os/image/disk\",\n"
			       "                        \"environment\": [],\n"
			       "                        \"externalConsole\": false,\n"
			       "                        \"MIMode\": \"gdb\",\n"
			       "                        \"setupCommands\": [\n"
			       "                                {\n"
			       "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
			       "                                        \"text\": \"-enable-pretty-printing\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                },\n"
			       "                                {\n"
			       "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
			       "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                }\n"
			       "                        ]\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-disk-compile-Debug-i386\",\n"
			       "                        \"type\": \"cppdbg\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-disk-compile-Debug-i386\",\n"
			       "                        \"program\": \"${workspaceFolder}/bin/Debug-i386/os/kernel/elf/kernel.elf\",\n"
			       "                        \"args\": [],\n"
			       "                        \"miDebuggerServerAddress\": \"localhost:1234\",\n"
			       "                        \"stopAtEntry\": false,\n"
			       "                        \"cwd\": \"${workspaceFolder}/os/image/disk\",\n"
			       "                        \"environment\": [],\n"
			       "                        \"externalConsole\": false,\n"
			       "                        \"MIMode\": \"gdb\",\n"
			       "                        \"setupCommands\": [\n"
			       "                                {\n"
			       "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
			       "                                        \"text\": \"-enable-pretty-printing\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                },\n"
			       "                                {\n"
			       "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
			       "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                }\n"
			       "                        ]\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-disk-compile-Release-x86_64\",\n"
			       "                        \"type\": \"f5anything\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-disk-compile-Release-x86_64\"\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-disk-compile-Release-i386\",\n"
			       "                        \"type\": \"f5anything\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-disk-compile-Release-i386\"\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-floppy-compile-Debug-x86_64\",\n"
			       "                        \"type\": \"cppdbg\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-floppy-compile-Debug-x86_64\",\n"
			       "                        \"program\": \"${workspaceFolder}/bin/Debug-x86_64/os/kernel/elf/kernel.elf\",\n"
			       "                        \"args\": [],\n"
			       "                        \"miDebuggerServerAddress\": \"localhost:1234\",\n"
			       "                        \"stopAtEntry\": false,\n"
			       "                        \"cwd\": \"${workspaceFolder}/os/image/floppy\",\n"
			       "                        \"environment\": [],\n"
			       "                        \"externalConsole\": false,\n"
			       "                        \"MIMode\": \"gdb\",\n"
			       "                        \"setupCommands\": [\n"
			       "                                {\n"
			       "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
			       "                                        \"text\": \"-enable-pretty-printing\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                },\n"
			       "                                {\n"
			       "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
			       "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                }\n"
			       "                        ]\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-floppy-compile-Debug-i386\",\n"
			       "                        \"type\": \"cppdbg\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-floppy-compile-Debug-i386\",\n"
			       "                        \"program\": \"${workspaceFolder}/bin/Debug-i386/os/kernel/elf/kernel.elf\",\n"
			       "                        \"args\": [],\n"
			       "                        \"miDebuggerServerAddress\": \"localhost:1234\",\n"
			       "                        \"stopAtEntry\": false,\n"
			       "                        \"cwd\": \"${workspaceFolder}/os/image/floppy\",\n"
			       "                        \"environment\": [],\n"
			       "                        \"externalConsole\": false,\n"
			       "                        \"MIMode\": \"gdb\",\n"
			       "                        \"setupCommands\": [\n"
			       "                                {\n"
			       "                                        \"description\": \"Enable pretty-printing for gdb\",\n"
			       "                                        \"text\": \"-enable-pretty-printing\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                },\n"
			       "                                {\n"
			       "                                        \"description\": \"Set Disassembly Flavor to Intel\",\n"
			       "                                        \"text\": \"-gdb-set disassembly-flavor intel\",\n"
			       "                                        \"ignoreFailures\": true\n"
			       "                                }\n"
			       "                        ]\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-floppy-compile-Release-x86_64\",\n"
			       "                        \"type\": \"f5anything\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-floppy-compile-Release-x86_64\"\n"
			       "                },\n"
			       "                {\n"
			       "                        \"name\": \"image-floppy-compile-Release-i386\",\n"
			       "                        \"type\": \"f5anything\",\n"
			       "                        \"request\": \"launch\",\n"
			       "                        \"preLaunchTask\": \"image-floppy-compile-Release-i386\"\n"
			       "                }\n"
			       "        ]\n"
			       "}\n";

TEST(c_small)
{
	START;

	test_gen_file_t out[] = {
		{
			.path = "tmp/Makefile",
			.data = SLN_TEST,
		},
		{
			.path = "tmp/test/Makefile",
			.data = PROJ_C,
		},
		{
			.path = "tmp/.vscode/tasks.json",
			.data = TASKS,
		},
		{
			.path = "tmp/.vscode/launch.json",
			.data = LAUNCH,
		},
	};

	const int ret = test_gen(vc_sln_gen, NULL, c_small_in, sizeof(c_small_in), out, sizeof(out));
	EXPECT_EQ(ret, 0);

	END;
}

TEST(c_args)
{
	START;

	test_gen_file_t out[] = {
		{
			.path = "tmp/Makefile",
			.data = SLN_TEST,
		},
		{
			.path = "tmp/test/Makefile",
			.data = PROJ_C,
		},
		{
			.path = "tmp/.vscode/tasks.json",
			.data = TASKS,
		},
		{
			.path = "tmp/.vscode/launch.json",
			.data = LAUNCH_ARGS,
		},
	};

	const int ret = test_gen(vc_sln_gen, NULL, c_args_in, sizeof(c_args_in), out, sizeof(out));
	EXPECT_EQ(ret, 0);

	END;
}

TEST(cpp_small)
{
	START;

	test_gen_file_t out[] = {
		{
			.path = "tmp/Makefile",
			.data = SLN_TEST,
		},
		{
			.path = "tmp/test/Makefile",
			.data = PROJ_CPP,
		},
		{
			.path = "tmp/.vscode/tasks.json",
			.data = TASKS,
		},
		{
			.path = "tmp/.vscode/launch.json",
			.data = LAUNCH,
		},
	};

	const int ret = test_gen(vc_sln_gen, NULL, cpp_small_in, sizeof(cpp_small_in), out, sizeof(out));
	EXPECT_EQ(ret, 0);

	END;
}

TEST(os)
{
	START;

	test_gen_file_t out[] = {
		{
			.path = "tmp/Makefile",
			.data = OS_SLN,
		},
		{
			.path = "tmp/os/boot/bin/Makefile",
			.data = OS_PROJ_BOOT_BIN,
		},
		{
			.path = "tmp/toolchain/gcc/Makefile",
			.data = OS_PROJ_GCC,
		},
		{
			.path = "tmp/os/kernel/bin/Makefile",
			.data = OS_PROJ_KERNEL_BIN,
		},
		{
			.path = "tmp/os/kernel/elf/Makefile",
			.data = OS_PROJ_KERNEL_ELF,
		},
		{
			.path = "tmp/os/image/disk/Makefile",
			.data = OS_PROJ_IMAGE_DISK,
		},
		{
			.path = "tmp/os/image/floppy/Makefile",
			.data = OS_PROJ_IMAGE_FLOPPY,
		},
		{
			.path = "tmp/.vscode/tasks.json",
			.data = OS_TASKS,
		},
		{
			.path = "tmp/.vscode/launch.json",
			.data = OS_LAUNCH,
		},

	};

	const int ret = test_gen(vc_sln_gen, NULL, os_in, sizeof(os_in), out, sizeof(out));
	EXPECT_EQ(ret, 0);

	END;
}

STEST(vc)
{
	SSTART;
	RUN(c_small);
	RUN(c_args);
	RUN(cpp_small);
	RUN(os);
	SEND;
}
